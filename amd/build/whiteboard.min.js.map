{"version":3,"file":"whiteboard.min.js","sources":["../src/whiteboard.js"],"sourcesContent":["define(['jquery'], function ($) {\n\n    return {\n        init: function (uniqid) {\n            var canvas = document.getElementById(uniqid + '_wb_canvas');\n            var clearBtn = document.getElementById(uniqid + '_clear_btn');\n            var hiddenInput = document.getElementById(uniqid + '_hidden');\n\n            if (!canvas || !clearBtn || !hiddenInput) {\n                console.warn('Whiteboard elements not found for id: ' + uniqid);\n                return;\n            }\n\n            var ctx = canvas.getContext(\"2d\");\n            var drawing = false;\n\n            // Defaults\n            ctx.lineWidth = 7;\n            ctx.lineCap = \"round\";\n            ctx.strokeStyle = \"black\";\n\n            // Color selection\n            var colorsDiv = document.getElementById(uniqid + '_colors');\n            if (colorsDiv) {\n                var colors = colorsDiv.querySelectorAll('.block_profilepic_color');\n                colors.forEach(function (color) {\n                    color.addEventListener('click', function () {\n                        // Update visual selection\n                        colors.forEach(function (c) { c.style.border = '1px solid #ccc'; });\n                        this.style.border = '2px solid #000';\n\n                        // Update context\n                        ctx.strokeStyle = this.getAttribute('data-color');\n                    });\n                    // Set initial visual selection for default black\n                    if (color.getAttribute('data-color') === 'black') {\n                        color.style.border = '2px solid #000';\n                    }\n                });\n            }\n\n            // Size selection\n            var sizesDiv = document.getElementById(uniqid + '_sizes');\n            if (sizesDiv) {\n                var sizes = sizesDiv.querySelectorAll('.block_profilepic_size');\n                sizes.forEach(function (size) {\n                    size.addEventListener('click', function () {\n                        // Update visual selection\n                        sizes.forEach(function (s) { s.style.border = 'none'; });\n                        this.style.border = '2px solid #000';\n\n                        // Update context\n                        ctx.lineWidth = parseInt(this.getAttribute('data-size'));\n                    });\n                    // Set initial visual selection for default size 7\n                    if (size.getAttribute('data-size') === '7') {\n                        size.style.border = '2px solid #000';\n                    }\n                });\n            }\n\n\n            // Update hidden input on mouse up\n            function updateInput() {\n                hiddenInput.value = canvas.toDataURL(\"image/png\");\n            }\n\n            // Initial empty whiteboard state\n            updateInput();\n\n            function getPos(canvas, evt) {\n                var rect = canvas.getBoundingClientRect();\n                return {\n                    x: (evt.clientX - rect.left) / (rect.right - rect.left) * canvas.width,\n                    y: (evt.clientY - rect.top) / (rect.bottom - rect.top) * canvas.height\n                };\n            }\n\n            function startDraw(e) {\n                drawing = true;\n                draw(e);\n            }\n\n            function endDraw() {\n                drawing = false;\n                ctx.beginPath();\n                updateInput();\n            }\n\n            function draw(e) {\n                if (!drawing) return;\n\n                var pos;\n                if (e.type.includes(\"touch\")) {\n                    var touch = e.touches[0];\n                    var mouseEvent = new MouseEvent(\"mousemove\", {\n                        clientX: touch.clientX,\n                        clientY: touch.clientY\n                    });\n                    pos = getPos(canvas, mouseEvent);\n                } else {\n                    pos = getPos(canvas, e);\n                }\n\n                // ctx properties are set by event listeners, simplified draw here\n                // but need to ensure path is correct\n\n                ctx.lineTo(pos.x, pos.y);\n                ctx.stroke();\n                ctx.beginPath();\n                ctx.moveTo(pos.x, pos.y);\n            }\n\n            canvas.addEventListener(\"mousedown\", startDraw);\n            canvas.addEventListener(\"mouseup\", endDraw);\n            canvas.addEventListener(\"mousemove\", draw);\n            canvas.addEventListener(\"mouseout\", endDraw); // Stop drawing if leave canvas\n\n            // Touch support\n            canvas.addEventListener(\"touchstart\", function (e) {\n                e.preventDefault(); // Prevent scrolling while drawing\n                startDraw(e.touches[0]);\n            });\n            canvas.addEventListener(\"touchend\", function (e) {\n                e.preventDefault();\n                endDraw();\n            });\n            canvas.addEventListener(\"touchmove\", function (e) {\n                e.preventDefault();\n                draw(e);\n            });\n\n            clearBtn.addEventListener(\"click\", function () {\n                ctx.fillStyle = \"white\";\n                ctx.fillRect(0, 0, canvas.width, canvas.height);\n                // Reset to white fill but keep stroke style\n                updateInput();\n            });\n        }\n    };\n});\n"],"names":["define","$","init","uniqid","canvas","document","getElementById","clearBtn","hiddenInput","ctx","getContext","drawing","lineWidth","lineCap","strokeStyle","colorsDiv","colors","querySelectorAll","forEach","color","addEventListener","c","style","border","this","getAttribute","sizesDiv","sizes","size","s","parseInt","updateInput","startDraw","endDraw","draw","e","preventDefault","touches","fillStyle","fillRect","width","height","console","warn","value","toDataURL","getPos","evt","rect","getBoundingClientRect","x","clientX","left","right","y","clientY","top","bottom","beginPath","pos","type","includes","touch","mouseEvent","MouseEvent","lineTo","stroke","moveTo"],"mappings":"AAAAA,qCAAO,CAAC,WAAW,SAAUC,SAElB,CACHC,KAAM,SAAUC,YACRC,OAASC,SAASC,eAAeH,OAAS,cAC1CI,SAAWF,SAASC,eAAeH,OAAS,cAC5CK,YAAcH,SAASC,eAAeH,OAAS,cAE9CC,QAAWG,UAAaC,iBAKzBC,IAAML,OAAOM,WAAW,MACxBC,SAAU,EAGdF,IAAIG,UAAY,EAChBH,IAAII,QAAU,QACdJ,IAAIK,YAAc,YAGdC,UAAYV,SAASC,eAAeH,OAAS,cAC7CY,UAAW,KACPC,OAASD,UAAUE,iBAAiB,2BACxCD,OAAOE,SAAQ,SAAUC,OACrBA,MAAMC,iBAAiB,SAAS,WAE5BJ,OAAOE,SAAQ,SAAUG,GAAKA,EAAEC,MAAMC,OAAS,yBAC1CD,MAAMC,OAAS,iBAGpBd,IAAIK,YAAcU,KAAKC,aAAa,iBAGC,UAArCN,MAAMM,aAAa,gBACnBN,MAAMG,MAAMC,OAAS,yBAM7BG,SAAWrB,SAASC,eAAeH,OAAS,aAC5CuB,SAAU,KACNC,MAAQD,SAAST,iBAAiB,0BACtCU,MAAMT,SAAQ,SAAUU,MACpBA,KAAKR,iBAAiB,SAAS,WAE3BO,MAAMT,SAAQ,SAAUW,GAAKA,EAAEP,MAAMC,OAAS,eACzCD,MAAMC,OAAS,iBAGpBd,IAAIG,UAAYkB,SAASN,KAAKC,aAAa,iBAGR,MAAnCG,KAAKH,aAAa,eAClBG,KAAKN,MAAMC,OAAS,qBAYhCQ,cA6CA3B,OAAOgB,iBAAiB,YAAaY,WACrC5B,OAAOgB,iBAAiB,UAAWa,SACnC7B,OAAOgB,iBAAiB,YAAac,MACrC9B,OAAOgB,iBAAiB,WAAYa,SAGpC7B,OAAOgB,iBAAiB,cAAc,SAAUe,GAC5CA,EAAEC,iBACFJ,UAAUG,EAAEE,QAAQ,OAExBjC,OAAOgB,iBAAiB,YAAY,SAAUe,GAC1CA,EAAEC,iBACFH,aAEJ7B,OAAOgB,iBAAiB,aAAa,SAAUe,GAC3CA,EAAEC,iBACFF,KAAKC,MAGT5B,SAASa,iBAAiB,SAAS,WAC/BX,IAAI6B,UAAY,QAChB7B,IAAI8B,SAAS,EAAG,EAAGnC,OAAOoC,MAAOpC,OAAOqC,QAExCV,sBA/HAW,QAAQC,KAAK,yCAA2CxC,iBAsDnD4B,cACLvB,YAAYoC,MAAQxC,OAAOyC,UAAU,sBAMhCC,OAAO1C,OAAQ2C,SAChBC,KAAO5C,OAAO6C,8BACX,CACHC,GAAIH,IAAII,QAAUH,KAAKI,OAASJ,KAAKK,MAAQL,KAAKI,MAAQhD,OAAOoC,MACjEc,GAAIP,IAAIQ,QAAUP,KAAKQ,MAAQR,KAAKS,OAAST,KAAKQ,KAAOpD,OAAOqC,iBAI/DT,UAAUG,GACfxB,SAAU,EACVuB,KAAKC,YAGAF,UACLtB,SAAU,EACVF,IAAIiD,YACJ3B,uBAGKG,KAAKC,MACLxB,aAEDgD,OACAxB,EAAEyB,KAAKC,SAAS,SAAU,KACtBC,MAAQ3B,EAAEE,QAAQ,GAClB0B,WAAa,IAAIC,WAAW,YAAa,CACzCb,QAASW,MAAMX,QACfI,QAASO,MAAMP,UAEnBI,IAAMb,OAAO1C,OAAQ2D,iBAErBJ,IAAMb,OAAO1C,OAAQ+B,GAMzB1B,IAAIwD,OAAON,IAAIT,EAAGS,IAAIL,GACtB7C,IAAIyD,SACJzD,IAAIiD,YACJjD,IAAI0D,OAAOR,IAAIT,EAAGS,IAAIL"}